## Quaternion이란?

쿼터니언(Quaternion)은 선형대수학과 3차원 및 4차원 공간에서의 회전을 다루는데 널리 사용되는 수학적 개념입니다. 쿼터니언은 복소수의 확장으로, 복소수가 실수부와 허수부의 조합으로 이루어져 있다면, 쿼터니언은 실수부와 세 개의 독립적인 허수부로 구성됩니다.

좋은 자료

1. https://www.youtube.com/watch?v=zjMuIxRvygQ
2. https://pasus.tistory.com/86?category=1176714

![](/week2/images/quaternion.png)

### 쿼터니언의 정의

쿼터니언 $( q )$는 다음과 같이 표현됩니다:
$(q = a + bi + cj + dk)$
여기서 $( a, b, c, d )$는 실수이며, $( i, j, k )$는 쿼터니언의 허수 단위입니다. 이 허수 단위들은 다음과 같은 곱셈 규칙을 따릅니다:
- $( i^2 = j^2 = k^2 = ijk = -1 )$
- $( ij = k, ; ji = -k )$
- $( jk = i, ; kj = -i )$
- $( ki = j, ; ik = -j )$

### 선형대수학적 관점

선형대수학에서 쿼터니언은 4차원 벡터공간을 구성합니다. 쿼터니언의 각 요소는 4차원 공간의 기저 벡터에 대응할 수 있습니다. 즉, 쿼터니언은 $( \mathbb{R}^4 )$의 한 점이나 벡터로 해석될 수 있습니다.

#### 회전과 쿼터니언

쿼터니언은 3차원 공간에서의 회전을 표현하는 데 매우 유용합니다. 쿼터니언을 이용한 회전은 다음과 같은 이점을 가집니다:
- **짐벌락(Gimbal Lock) 회피**: 오일러 각을 사용할 때 발생하는 짐벌락 문제를 피할 수 있습니다.
- **보간 용이성**: 두 회전 사이의 부드러운 전환(보간)을 쉽게 계산할 수 있습니다.
- **효율적인 연산**: 행렬을 이용한 회전보다 연산이 더 효율적일 수 있습니다.

회전 쿼터니언은 일반적으로 다음과 같이 표현됩니다:
$ q = \cos(\theta/2) + (xi + yj + zk) \sin(\theta/2) $
여기서 $ (x, y, z) $는 회전축을 나타내는 단위 벡터이고, $\theta$ 는 회전 각도입니다.

### 쿼터니언의 연산

쿼터니언의 주요 연산에는 덧셈, 곱셈, 스칼라 곱셈, 그리고 켤레 및 역원 구하기 등이 있습니다. 쿼터니언의 곱셈은 비교적 복잡하며, 곱셈 규칙(위에서 언급한 \( i, j, k \)의 관계)을 따릅니다. 이러한 곱셈은 일반적으로 비가환(non-commutative)입니다.

### 응용 분야

쿼터니언은 컴퓨터 그래픽스, 로봇공학, 항공우주 공학 등 다양한 분야에서 3차원 공간의 회전을 처리하는 데 널리 사용됩니다. 그 효율성과 짐벌락 문제를 회피할 수 있는 장점 때문에

 매우 유용한 도구로 여겨집니다.

물론입니다. 위 예제에서 제가 정의한 `Quaternion` 클래스는 쿼터니언의 기본적인 속성과 연산을 모방하기 위해 만들어진 Python 클래스입니다. 쿼터니언은 일반적으로 실수 부분과 세 개의 허수 부분으로 구성되는 4차원 복소수입니다. 이 클래스를 통해 쿼터니언을 표현하고, 기본적인 쿼터니언 연산(곱셈과 회전)을 구현했습니다.

### 클래스 구조

```python
class Quaternion:
    def __init__(self, w, x, y, z):
        ...
    def rotate(self, point):
        ...
    def __mul__(self, other):
        ...
```

1. **`__init__(self, w, x, y, z)`**: 
   이 생성자 메서드는 쿼터니언의 네 가지 요소(실수부 `w`와 허수부 `x`, `y`, `z`)를 초기화합니다. 쿼터니언은 일반적으로 `q = w + xi + yj + zk` 형태로 표현됩니다.

2. **`rotate(self, point)`**: 
   이 메서드는 3차원 공간의 점(벡터)을 주어진 쿼터니언으로 회전시키는 기능을 수행합니다. 회전은 쿼터니언의 곱셈을 이용해 구현됩니다. 우선, 회전하고자 하는 점을 쿼터니언 형태로 변환한 후, 해당 쿼터니언을 사용하여 점을 회전시킵니다. 회전은 다음과 같은 식을 이용합니다: `q_rotated = q * q_point * q_conj`, 여기서 `q_conj`는 주어진 쿼터니언의 켤레입니다.

3. **`__mul__(self, other)`**: 
   이 메서드는 두 쿼터니언 간의 곱셈을 정의합니다. 쿼터니언의 곱셈은 복잡한 규칙을 따르며, 벡터 곱셈과 유사한 방식으로 이루어집니다. 이 곱셈은 일반적인 복소수 곱셈과는 다르며, 각 쿼터니언 요소 간의 상호작용을 포함합니다.

### 쿼터니언 회전

쿼터니언을 이용한 회전은 다음 단계를 따릅니다:
1. 회전하려는 점을 쿼터니언으로 변환합니다 (이 경우 점의 쿼터니언의 실수부는 0입니다).
2. 주어진 쿼터니언(`q`)으로 점을 회전시킵니다. 이는 `q * point_quaternion * q_conjugate`로 계산됩니다.
3. 결과 쿼터니언의 벡터 부분을 추출하여 회전된 점의 위치를 얻습니다.

### 쿼터니언 곱셈

쿼터니언 곱셈은 다음과 같은 식을 따릅니다:
$ (w_1 + x_1i + y_1j + z_1k) \times (w_2 + x_2i + y_2j + z_2k) $
이 곱셈은 각 성분을 곱하고, 쿼터니언의 기본 곱셈 규칙(`i^2 = j^2 = k^2 = ijk = -1` 등)을 적용하여 계산됩니다.

### 결론

이 `Quaternion` 클래스는 Python에서 쿼터니언의 기본적인 표현과 연산을 가능하게 하며, 특히 3차원 공간에서의 회전을 처리하는데

 유용합니다. 실제 적용 예로는 컴퓨터 그래픽스, 로봇 공학, 물리 시뮬레이션 등이 있습니다.

### Quaternion to rotation matrix

 쿼터니언을 회전 행렬로 변환하는 데 사용되는 행렬입니다. 이 행렬의 이름은 "쿼터니언 회전 행렬(Quaternion Rotation Matrix)"이라고 합니다. 이 행렬은 쿼터니언 \( q = w + xi + yj + zk \)을 기반으로 하여 3차원 공간에서의 회전을 나타내는 3x3 회전 행렬을 생성합니다.

이 회전 행렬은 쿼터니언의 각 성분을 사용하여 계산되며, 쿼터니언이 나타내는 3D 회전을 행렬 연산으로 표현할 수 있도록 합니다. 이러한 변환은 컴퓨터 그래픽스, 로봇공학, 항공우주 공학 등 여러 분야에서 중요한 역할을 합니다. 

회전 행렬 $( R )$은 쿼터니언의 각 요소를 사용하여 다음과 같이 계산됩니다:


$R = \begin{bmatrix} 1-2y^2 - 2z^2 & 2xy-2zw & 2xz+2yw \\ 2xy+2zw & 1-2x^2-2z^2 & 2yz - 2xw \\ 2xz - 2yw & 2yz+2xw & 1-2x^2-2y^2 \end{bmatrix}$

여기서 $( x, y, z )$는 쿼터니언의 허수 부분, $( w )$는 실수 부분입니다. 이 행렬은 주어진 쿼터니언으로 벡터를 회전시키는 데 사용될 수 있습니다.